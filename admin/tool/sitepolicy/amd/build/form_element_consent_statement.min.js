define(["jquery","totara_form/form","core/templates"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),void(this.input=null)):new c(a,d,e,f)}return c.prototype=Object.create(b.Element.prototype),c.constructor=c,c.prototype.toString=function(){return"[object ConsentStatement]"},c.prototype.init=function(b){var c=this.getForm(),d=a(this.getNode()),e=d.find('input[data-rel="addstatement"]'),f=d.find('input[data-rel="removestatement"]'),g=a("#"+this.id).attr("data-element-name"),h=a(d.find('input[name="'+g+'__addstatement"]')),i=this;e.on("click",function(){h.val(1),c.reload()}),f.on("click",function(b){M.util.js_pending("tool_sitepolicy-consent_statement_removal"),b.preventDefault();var c,d=a(this),e=a(d.closest('div[data-rel="statement-block"]')),f=a(e.find('input[name="'+g+"__removedstatement["+d.data("index")+']"]'));c=i.delete_confirm(b,function(){f.val(1),e.addClass("hidden"),e.find("input[required]").removeAttr("required")}),c.done(function(){M.util.js_complete("tool_sitepolicy-consent_statement_removal")})}),b()},c.prototype.delete_confirm=function(b,c){var d=a.Deferred();return require(["core/modal_factory","core/modal_events","core/str"],function(e,f,g){var h=[{key:"deleteconsentconfirmtitle",component:"tool_sitepolicy"},{key:"deleteconsentconfirmbody",component:"tool_sitepolicy"}],i=g.get_strings(h);i.done(function(g){var h={type:e.types.CONFIRM,title:g[0],body:g[1]},i=e.create(h,a(b));i.done(function(a){var b=a.getRoot();b.on(f.yes,c),b.on(f.shown,d.resolve),a.show()})})}),d.promise()},c});