define(["jquery"],function(a){var b,c=["audience_showing","preset_showing","tile_rules_showing"],d=function(b){var d=0;a.each(c,function(c,e){a("#tfiid_"+e+"_"+b).is(":checked")&&d++}),a("#tfiid_audience_showing_"+b).length||d++,d>=2?a('[data-element-id="tfiid_aggregation'+b+'"]').each(function(b,c){a(c).removeAttr("data-hidden")}):a('[data-element-id="tfiid_aggregation'+b+'"]').each(function(b,c){a(c).attr("data-hidden","")})},e=function(){a("[data-type=cohort_delete]").each(function(b,c){a(c).off("click"),a(c).click(function(b){a(b.target).closest("li").remove();var c=a(b.target).closest("a").attr("cohortid"),d=a('input[name="audiences_visible"]'),e=d.val().split(",");e.indexOf(c)!=-1&&e.splice(e.indexOf(c),1),d.val(e.join()),d.change()})})};return{init:function(f){b=f,a.each(c,function(b,c){a("#tfiid_"+c+"_"+f).on("change",function(){d(f)})}),a("#tfiid_visibility_"+f).on("change",function(){"2"!=a("input[name=visibility]:checked","#tfiid_visibility_"+f).val()?a('[data-element-id="tfiid_aggregation'+f+'"]').each(function(b,c){a(c).attr("data-hidden","")}):(d(f),e())}),e(),"2"!=a("input[name=visibility]:checked","#tfiid_visibility_"+f).val()?a('[data-element-id="tfiid_aggregation'+f+'"]').each(function(b,c){a(c).attr("data-hidden","")}):d(f)},add_audience_table_listeners:e,add_to_audience_id:function(b){if(0!==b.length){var c=a('input[name="audiences_visible"]');c.val(c.val()+(0===c.val().length?"":",")+b),c.change()}},add_to_audience_list:function(b){a("#audience_visible_table").append(b)},audience_list_contains:function(b){return a("#audience_visible_table").find('span[cohortid="'+b+'"]').length}}});