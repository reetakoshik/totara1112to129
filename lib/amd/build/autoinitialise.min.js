define(["core/log"],function(a){var b="data-core-autoinitialise",c="data-core-autoinitialise-amd",d="true",e="initialising",f="done",g="error",h=function(){for(var h=[],i=document.querySelectorAll("["+b+"="+d+"]"),j=function(c,d){a.error(d),c.setAttribute(b,g)},k=function(a,c){var d=function(d){require([c],function(e){if("undefined"==typeof e.init)return j(a,'AMD module "'+c+'" cannot be autoinitialised because init method is missing'),void d();try{var g=e.init(a);g&&"function"==typeof g.then?g.then(function(){a.setAttribute(b,f),d()})["catch"](function(b){j(a,b),d()}):(a.setAttribute(b,f),d())}catch(h){j(a,'AMD module "'+c+'" failed to autoinitialise'),d()}},function(){j(a,'Failed to load AMD module "'+c+'"'),d()})};return d},l=0;l<i.length;l++){var m=i[l],n=m.getAttribute(c);if(null!==n)if(n.match(/^[a-zA-Z0-9\/_-]+$/g)){m.setAttribute(b,e);var o=k(m,n),p=new Promise(o);h.push(p)}else j(m,'AMD module cannot be autoinitialised because "'+c+'" attribute is invalid');else j(m,'AMD module cannot be autoinitialised because "'+c+'" attribute is missing')}return Promise.all(h)};return{scan:h}});