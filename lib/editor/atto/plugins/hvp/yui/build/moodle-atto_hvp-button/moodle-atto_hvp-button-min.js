YUI.add("moodle-atto_hvp-button",function(e,t){var n="atto_hvp",r={INPUTHVP:"atto_hvp_inputhvp"},i={INPUTHVP:".atto_hvp_inputhvp"},s='<form class="atto_form">{{get_string "select_desc" component}}<br/><br/>{{#if hvps}}<label for="{{elementid}}_atto_hvp_">{{get_string "hvp" component}}</label><select class="{{CSS.INPUTHVP}}" id="{{elementid}}_hvp_inputhvp">{{#each hvps}}<option value="{{id}}">{{text}}</option>{{/each}}</select><br/><div class="mdl-align"><br/><button type="submit" class="submit">{{get_string "inserthvp" component}}</button></div>{{else}}{{get_string "nohvps" component}}{{/if}}</form>',o='<iframe src="'+M.cfg.wwwroot+'{{hvpurl}}" class="filter_hvp" id="hvp_{{id}}" style="width:100%; height:auto; border:0;" frameborder="0" allowfullscreen="allowfullscreen">'+"</iframe>"+'<script src="'+M.cfg.wwwroot+'/mod/hvp/library/js/h5p-resizer.js" charset="UTF-8"></script>';e.namespace("M.atto_hvp").Button=e.Base.create("button",e.M.editor_atto.EditorPlugin,[],{_currentSelection:null,_content:null,initializer:function(){var e=this.get("capability"),t=[];e&&this.addButton({icon:"icon",iconComponent:"atto_hvp",callback:this._displayDialogue})},_displayDialogue:function(){this._currentSelection=this.get("host").getSelection();if(this._currentSelection===!1||this._currentSelection.collapsed)return;var e=this.getDialogue({headerContent:M.util.get_string("pluginname",n),focusAfterHide:!0,focusOnShowSelector:i.INPUTHVP});e.set("bodyContent",this._getDialogueContent()),e.show()},_getDialogueContent:function(){var t=e.Handlebars.compile(s);return this._content=e.Node.create(t({component:n,hvps:this.get("hvps"),CSS:r})),this._content.one(".submit")&&this._content.one(".submit").on("click",this._inserthvp,this),this._content},_inserthvp:function(t){var n,r,i,s=this.get("host");t.preventDefault(),this.getDialogue({focusAfterHide:null}).hide(),n=this._content.one(".atto_hvp_inputhvp"),i=n.get("text"),r=n.get("value"),s.focus(),r!==""&&(template=e.Handlebars.compile(o),imagehtml=template({id:r,text:i,hvpurl:"/mod/hvp/embed.php?id="+r}),s.insertContentAtFocusPoint(imagehtml),this.markUpdated()),this.getDialogue({focusAfterHide:null}).hide()}},{ATTRS:{hvps:{value:[]},capability:{value:[]}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});
