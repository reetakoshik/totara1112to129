define(["jquery","core/config"],function(a,b){var c={config:{},totaraDialog_handler_preRequisite:null,init:function(b){b&&("string"==typeof b&&(b=a.parseJSON(b)),c.config=b),c.add_handlers(),c.totaraDialog_handler_preRequisite=function(){},c.totaraDialog_handler_preRequisite.prototype=new totaraDialog_handler_treeview_multiselect,c.totaraDialog_handler_preRequisite.prototype._update=function(a){this._dialog.hide(),c.totara_totara_plan_update(a)}},add_handlers:function(){jQuery("table.dp-plan-component-items input, table.dp-plan-component-items select").change(function(){var d={updatesettings:"1",ajax:"1",sesskey:b.sesskey,page:c.config.page};d[a(this).attr("name")]=a(this).val(),a.post(b.wwwroot+"/totara/plan/component.php?id="+c.config.plan_id+"&c="+c.config.component_name+"&page="+c.config.page,d,c.totara_totara_plan_update)})},totara_totara_plan_update:function(b){a(".noitems-assign"+c.config.component_name).remove();var d=a(b).find("table.dp-plan-component-items"),e=a(b).filter(".plan_box"),f=a(b).filter(".paging")[0],g=a("form#dp-component-update table.dp-plan-component-items"),h=a(b).filter("span.noitems-assign"+c.config.component_name),i=a("div#dp-component-update-submit");h.length?(a("form#dp-component-update div#dp-component-update-table").append(h),g.empty(),i.hide()):g.length?(g.replaceWith(d),i.show()):(a("form#dp-component-update div#dp-component-update-table").append(d),i.show()),a("div.plan_box").replaceWith(e),a(".paging").replaceWith(f),c.add_handlers(),require(["core/str"],function(a){a.get_string("datepickerlongyeardisplayformat","totara_core").done(function(a){M.totara_core.build_datepicker(null,"[id^=duedate_"+c.config.component_name+"]",a)})})}};return c});