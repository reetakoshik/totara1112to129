define(["core/yui"],function(a){return M.totara_form=M.totara_form||{},M.totara_form.element_filepicker=M.totara_form.element_filepicker||{},M.totara_form.element_filepicker.instances=M.totara_form.element_filepicker.instances||[],M.totara_form.element_filepicker.callback=function(a){var b='<div class="filepicker-container"><a href="'+a.url+'">'+a.file+"</a></div>";b+='<div class="dndupload-progressbars"></div>',M.totara_form.element_filepicker.Y.one("#file_info_"+a.client_id+" .filepicker-filename").setContent(b);var c=M.core_filepicker.instances[a.client_id].options.elementname;M.totara_form.element_filepicker.instances[c].fileadded=!0},M.totara_form.element_filepicker.init=function(a,b){M.totara_form.element_filepicker.Y=a,M.totara_form.element_filepicker.instances[b.elementname]={},M.totara_form.element_filepicker.instances[b.elementname].fileadded=!1,b.formcallback=M.totara_form.element_filepicker.callback,M.core_filepicker.instances[b.client_id]||M.core_filepicker.init(a,b),a.on("click",function(a,b){a.preventDefault(),null===this.ancestor(".fitem.disabled")&&M.core_filepicker.instances[b].show()},"#filepicker-button-"+b.client_id,null,b.client_id);var c=document.getElementById("filepicker-wrapper-"+b.client_id);c&&(c.style.display="");var d={clientid:b.client_id,acceptedtypes:b.accepted_types,author:b.author,maxfiles:-1,maxbytes:b.maxbytes,itemid:b.itemid,repositories:b.repositories,formcallback:b.formcallback,containerprefix:"#file_info_",containerid:"file_info_"+b.client_id,contextid:b.context.id};M.form_dndupload.init(a,d)},{init_filepicker:function(b){a.use(["core_filepicker","node","node-event-simulate","core_dndupload"],function(a){M.core_filepicker.set_templates(a,b.fptemplates),b.fptemplates=null,M.totara_form.element_filepicker.init(a,b)})}}});