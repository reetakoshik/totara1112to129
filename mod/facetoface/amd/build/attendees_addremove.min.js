define(["jquery","core/str","core/config"],function(a,b,c){var d={init:function(b){var c=a("a.viewbulkresults:first");c.length>0&&d.setupResultsDialog(c,b.s,b.listid),a("#add").click(function(b){b.preventDefault();var c=a("#addselect").find("option:selected");c.each(function(b,c){var d=0;a("#removeselect option").length&&a("#removeselect option").each(function(b,e){a(e).data("idx")<a(c).data("idx")&&(d=a(e).data("idx"))}),d>0?a(c).insertAfter(a("#removeselect option[data-idx="+d+"]")):a("#removeselect").append(c)})}),a("#remove").click(function(b){b.preventDefault();var c=a("#removeselect").find("option:selected");c.each(function(b,c){var d=0;a("#addselect option").length&&a("#addselect option").each(function(b,e){a(e).data("idx")<a(c).data("idx")&&(d=a(e).data("idx"))}),d>0?a(c).insertAfter(a("#addselect option[data-idx="+d+"]")):a("#addselect").append(c)})}),a("#interested").click(function(){a("form#assignform").submit()}),a("#searchtext, #searchtoremovetext").focus(function(){a("#add").attr("disabled","disabled"),a("#remove").attr("disabled","disabled")}),a("#removeselect").focus(function(){a("#add").attr("disabled","disabled"),a("#remove").removeAttr("disabled")}),a("#addselect").focus(function(){a("#add").removeAttr("disabled"),a("#remove").attr("disabled","disabled")}),a("#assignform").submit(function(){a("#removeselect option").each(function(){a(this).prop("disabled")?a(this).prop("selected",!1):a(this).prop("selected",!0)})}),a("#searchtoremovetext").on("keyup keypress blur change",function(){var b=a("#searchtoremovetext").val();b.length>0?(a("#searchtoremovereset").show(),a("#removeselect option").each(function(c,d){var e=a(d);e.text().search(b)!==-1?e.show():e.hide()})):(a("#searchtoremovereset").hide(),a("#removeselect option").show())}),a("#searchtoremovereset").click(function(b){b.preventDefault(),a("#searchtoremovetext").val(""),a("#searchtoremovetext").trigger("change")})},setupResultsDialog:function(a,d,e){a.attr("id","viewbulkresults");var f=[];f.push({key:"bulkaddattendeesresults",component:"facetoface"}),f.push({key:"closebuttontitle",component:"moodle"}),b.get_strings(f).done(function(a){var b=function(){for(var b=new totaraDialog_handler,g=[],h=0;h<f.length;h++)g[f[h].key]=a[h];var i="bulkaddvalidation",j={};j[g.closebuttontitle]=function(){b._cancel()},totaraDialogs[i]=new totaraDialog(i,"viewbulkresults",{title:"<h2>"+g.bulkaddattendeesresults+"</h2>",buttons:j},c.wwwroot+"/mod/facetoface/attendees/ajax/bulk_add.php?s="+d+"&listid="+e,b)};window.dialogsInited?b():(window.dialoginits=window.dialoginits||[],window.dialoginits.push(b))})}};return d});